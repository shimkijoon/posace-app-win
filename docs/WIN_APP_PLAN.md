# POS Windows 앱 개발 계획

> 목적: Windows POS 클라이언트 개발을 단계별로 진행하기 위한 계획서
> 범위: Windows 우선 개발 후 Android 확장 대비

## 0) 목표/원칙

- 로컬 DB는 SQLite 사용
- 앱 실행 시 마스터 자동 동기화 + 수동 동기화 버튼 제공
- 매출은 즉시 업로드 + 실패 시 큐에 저장 후 재시도
- 로컬 DB는 언제든 삭제 후 서버 마스터로 복구 가능
- 전세계 오픈을 고려해 다국어/통화/세금/시간대 대응
- 국가별 세금(부가세/판매세 등) 차이를 고려한 계산 구조
- 영수증 출력 기능 포함
- 결제단말기 연동은 국가별로 순차 지원

## 0-1) 업종 모드(유통/외식) 전략

### 업종별 차이 요약
- 유통업(리테일): 바코드 기반 빠른 판매, 상품/재고 중심, 단순 주문 구조
- 외식업(레스토랑): 테이블/좌석, 코스/주문 흐름, 주방 전송, 팁/봉사료 등

### 코드 관리 방식 제안
- **단일 코드베이스 + 모드 선택(권장)**
  - 공통(core/data/sync) 레이어 공유
  - UI/업무흐름만 모듈 분리(유통/외식)
  - 런타임 모드 선택 또는 매장 설정으로 분기
- 대안: 레포 분리(유지보수/릴리즈 비용 증가, 공통 로직 중복)

### 우선 구현 추천
- **유통업 모드 우선**
  - 기능 범위가 단순해 MVP 출시가 빠름
  - 이후 외식업 기능(테이블/주방)을 모듈로 추가
  - 글로벌 확장 시 리테일 수요가 더 광범위

## 1) 기반 구조

- 프로젝트 구조 (권장)
  - `core/` 도메인/유스케이스
  - `data/` API/SQLite/리포지토리
  - `ui/` 화면/위젯
  - `sync/` 동기화/큐/재시도
- 환경설정: `API_BASE_URL`, POS 토큰 저장

## 2) 인증/디바이스 등록

- 백오피스에서 POS 디바이스 토큰 발급
- 앱에서 디바이스 토큰 입력 → POS 로그인
- POS JWT 저장

## 3) 마스터 동기화

- `GET /pos/stores/{storeId}/master` 호출
- SQLite에 카테고리/상품/할인 저장
- `updatedAfter` 기반 증분 동기화
- 수동 동기화 버튼 제공

## 4) 판매/장바구니

- 상품 검색/추가/수량 변경
- 할인 적용(상품/장바구니)
- 결제 수단 선택

## 5) 매출 업로드

- 결제 완료 즉시 업로드
- 실패 시 로컬 큐 저장
- 백그라운드/재시도 처리

## 6) 재고/상품 상태 동기화

- 재고 조정
- 상품 판매중/중지 토글

## 7) 세션/마감

- 오픈/클로즈 금액 입력
- 차이(variance) 계산 및 기록

## 8) 로그/모니터링 (선택)

- 에러/상태 로그 업로드

## 9) 진행 체크리스트

- [x] 1) 기반 구조
- [ ] 2) 인증/디바이스 등록
- [ ] 3) 마스터 동기화
- [ ] 4) 판매/장바구니
- [ ] 5) 매출 업로드
- [ ] 6) 재고/상품 상태 동기화
- [ ] 7) 세션/마감
- [ ] 8) 로그/모니터링
